# ☁️ 雲端同步設置指南

## 🚀 **快速開始**

### **第一步：設置 Google Apps Script**

1. **打開您的 Google Apps Script 項目**
   - 訪問：https://script.google.com
   - 點擊您的 "未命名的專案"

2. **貼上後端代碼**
   - 複製 `GAS_Backend.js` 的所有內容
   - 貼到您的 Apps Script 編輯器中
   - 點擊 💾 **儲存**

3. **部署為 Web 應用程式**
   - 點擊右上角 **"部署"** → **"新增部署"**
   - 選擇類型：**"網頁應用程式"**
   - 執行身分：**"我"**
   - 存取權限：**"任何人"** (重要！)
   - 點擊 **"部署"**
   - 複製 Web 應用程式 URL

### **第二步：配置行動端應用**

1. **開啟雲端同步頁面**
   - 首頁 → ☁️ **雲端同步**

2. **輸入 API 設定**
   - **Google Apps Script URL**: 貼上剛才複製的 URL
   - **同步權限**: 選擇適當權限
   - 點擊 💾 **儲存設定**

3. **測試連線**
   - 點擊 🔗 **測試連線**
   - 確認顯示 "連線成功"

### **第三步：開始同步**

1. **選擇同步資料**
   - ✅ 盤點紀錄
   - ✅ 人員資料
   - ✅ 區域設定
   - ✅ 產品分類

2. **執行同步**
   - 📤 **上傳到雲端**: 將本地資料同步到 Google Sheets
   - 📥 **從雲端下載**: 下載雲端資料到本地
   - 🔄 **智能同步**: 雙向合併資料

---

## 🔐 **權限設定分析**

### **📖 只讀取 (Read Only)**
```
適用場景: 查看資料，不修改
功能範圍:
✅ 下載雲端資料
✅ 查看同步紀錄
❌ 上傳本地資料
❌ 修改雲端資料
```

**優點:**
- 🛡️ 資料安全，不會誤改
- 👥 適合一般查看人員
- 📊 可以下載最新報表

**缺點:**
- ⛔ 無法上傳新的盤點結果
- ⛔ 不能更新人員或區域設定

---

### **📝 讀寫 (Read & Write)** ⭐ 推薦
```
適用場景: 正常盤點作業
功能範圍:
✅ 上傳盤點紀錄
✅ 下載雲端資料
✅ 雙向同步
✅ 修改個人負責的資料
❌ 系統設定變更
```

**優點:**
- ⚡ 完整的盤點同步功能
- 🔄 可以雙向同步資料
- 📤 能上傳新的盤點結果
- 📥 能下載他人的盤點資料

**適用人員:**
- 倉庫盤點人員
- 現場操作人員
- 日常使用者

---

### **👑 管理員 (Admin)**
```
適用場景: 系統管理與維護
功能範圍:
✅ 所有讀寫功能
✅ 修改系統設定
✅ 管理人員權限
✅ 清除或重設資料
✅ 查看完整同步紀錄
```

**額外功能:**
- 🔧 修改區域設定
- 👥 新增/移除人員
- 📦 更新產品分類
- 🗑️ 清除歷史資料
- 📋 匯出完整報表

**適用人員:**
- 系統管理員
- IT 維護人員
- 倉庫主管

---

## 📊 **Google Sheets 資料結構**

同步後會自動創建以下工作表：

### **📋 盤點紀錄**
| 欄位 | 說明 | 範例 |
|------|------|------|
| 記錄ID | 唯一識別碼 | INV_20241215_001 |
| 時間戳記 | 盤點時間 | 2024/12/15 14:30:25 |
| 區域 | 盤點區域 | 散貨區貨架 |
| 盤點人員 | 負責人員 | 張小明 |
| 品項分類 | 商品分類 | 纖體組 |
| 品項名稱 | 具體品項 | 纖纖飲 |
| 數量 | 盤點數量 | 50 |
| 備註 | 額外說明 | 包裝完整 |

### **👥 人員管理**
| 欄位 | 說明 | 範例 |
|------|------|------|
| 員工ID | 員工代碼 | STAFF_001 |
| 姓名 | 員工姓名 | 張小明 |
| 部門 | 所屬部門 | 倉儲部 |
| 職位 | 職務 | 盤點人員 |
| 權限等級 | 系統權限 | write |
| 狀態 | 啟用狀態 | 啟用 |

### **🏭 區域設定**
| 欄位 | 說明 | 範例 |
|------|------|------|
| 區域代碼 | 區域代號 | AREA_001 |
| 區域名稱 | 顯示名稱 | 散貨區貨架 |
| 負責人員 | 主要負責人 | 張小明 |
| 產品分類 | 包含分類 | 纖體組, 美肌組 |
| 狀態 | 使用狀態 | 啟用 |

### **📦 產品分類**
| 欄位 | 說明 | 範例 |
|------|------|------|
| 分類名稱 | 分類名稱 | 纖體組 |
| 產品清單 | 包含產品 | 纖纖飲, 纖飄錠, 爆纖錠 |
| 產品數量 | 產品種類數 | 9 |
| 狀態 | 使用狀態 | 啟用 |

---

## 🔄 **同步策略說明**

### **📤 上傳到雲端**
- **作用**: 將本地儲存的盤點資料上傳到 Google Sheets
- **時機**: 完成一天的盤點工作後
- **特點**: 不會覆蓋雲端現有資料，採用新增方式

### **📥 從雲端下載**
- **作用**: 從 Google Sheets 下載其他人的盤點資料
- **時機**: 開始工作前同步最新狀況
- **特點**: 智能去重，避免重複下載相同資料

### **🔄 智能同步**
- **作用**: 先下載雲端資料，再上傳本地資料
- **時機**: 需要完整資料一致性時
- **特點**: 確保所有裝置資料同步

---

## ⚠️ **注意事項**

### **🔒 安全性**
- URL 包含敏感資訊，請勿分享
- 定期檢查 Google Sheets 存取權限
- 建議使用公司 Google 帳號

### **📶 網路需求**
- 同步需要穩定的網路連線
- 大量資料同步可能需要較長時間
- 建議在 WiFi 環境下進行同步

### **💾 資料備份**
- 本地資料會自動備份到 Google Sheets
- 建議定期匯出 Excel 檔案作為額外備份
- 重要資料變更前先進行手動備份

### **🔧 故障排除**
- 連線失敗：檢查網路和 URL 正確性
- 權限錯誤：確認 Apps Script 部署設定
- 資料遺失：檢查 Google Sheets 回收筒

---

## 📞 **技術支援**

遇到問題時，請提供以下資訊：
1. 📱 裝置型號和瀏覽器版本
2. 🌐 網路環境 (WiFi/4G)
3. ⚠️ 錯誤訊息截圖
4. 🔄 操作步驟重現

**您的智能倉儲系統現在具備完整的雲端協作能力！** ☁️🚀
